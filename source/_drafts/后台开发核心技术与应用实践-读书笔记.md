---
title: 后台开发核心技术与应用实践-读书笔记
date: 2019-08-12 22:09:50
tags:
---
# C++ 
* 如何判断是指针数组还是数组指针？

    依据运算符的优先级： ()>[]>*

    先与运算符结合的即为实际类别

    int *p[n] 表示指针数组

    int (*p)[n] 表示数组指针

* long 类型在32位机器上只占4Byte，其他类型在32位机器和64位机器都是占同样的大小空间
* union 中变量共用内存应以最长的为准

        #include<iostream>
        using namespace std;
        union A{
            int a[5J;
            char b;
            double c;
        }
        int main() {
            cout<<sizeof(A)<<endl;
            return O;
        }

    程序的执行结果是：
    24

    因为按照double的8字节的

* 宏定义使用注意事项

    当字符串中不只一个符号时，加上括号表现出优先级，如果是带数的宏定义，则要给宏体中的每个参数加上括号，并在整个宏体上再加一个括号 。

* do while 与宏定义结合使用 可以宏定义代码块， 同时保证代码块语义不会被拆解。

        #def 工ne Foo(x) do{\
            statement one;\
            statement two;\
        }while(0) //这里没有分号

* 条件编译 
* extern "C" 的使用

# 编译

## 编译与链接

* 4个步骤： 预处理(Prepressing)、编译(Compilation)、汇编(Assembly)、链接(Linking)

{% asset_img compilation.jpg image %}

* 预处理

    经过预处理之后的.i文件不包含任何宏定义，因为所有的宏定义已经被展开，并且包含的文件也已经被插入到.i文件中。

* 编译

    编译过程就是把预处理完的文件进行一系列的词法分析、语法分析、语义分析以及优化后产生相应的汇编代码文件，这个过程往往是整个程序构建的核心部分

* 链接

    把每个源代码模块独立地编译，然后按照要将它们“组装”起来，这个组装模块的过程就是链接 。 链接的主要内容就是把各个模块之间相互引用的部分都处理好，使得各个模块之间能够正确的衔接。

    * 静态链接

        对函数库的链接是放在编译时期完成的是静态链接。所有相关的目标文件与牵涉到的函数库被链接合成一个可执行文件。 程序在运行时，与函数库再无瓜葛，因为所有需要的函数已复制到相关位置。 这些函数库被称为静态库，通常文件名为“ libxxx.a”的形式 。
    
    * 动态链接

        对一些库函数的链接载入推迟到程序运行时期（runtime），这就是动态链接库（ dynamic link library）技术。动态库文件名命名规范和静态库文件名命名规范类似，也是在动态库名增加前缀lib但其文件扩展名为.        so。

        -fPIC ：表示编译为位置独立的代码 。不用此选项的话编译后的代码是位置相关的，所以动态载入时是通过代码复制的方式来满足不同进程的需要，而不能达到真正代码段共享的目的。<br>
        -Lpath ：表示在 path 目录中搜索库文件，如－L. 则表示在当前目录。<br>
        -Ipath ：表示在 path 目录中搜索头文件。<br>
        -ltest ：编译器查找动态连接库时有隐含的命名规则，即在给出的名字前面加lib,后面加上.so来确定库的名称。<br>

        * 动态库的搜索路径搜索的先后顺序是：

            (1)编译目标代码时指定的动态库搜索路径；<br>
            (2)环境变量 LD_LIBRARY_PATH 指定的动态库搜索路径；<br>
            (3)配置文件/etc/ld.so.conf中指定的动态库搜索路径；即只需在在该文件中追加一行库所在的完整路径如 "/root/test/conf/lib”即可，然后ldconfig 是修改生效；<br>
            (4)默认的动态库搜索路径/lib； <br>
            (5)默认的动态库搜索路径/usr/lib。